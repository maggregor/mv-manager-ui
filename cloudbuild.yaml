steps:
  - name: node:12.22.5
    entrypoint: yarn
    args: ['install']
  - name: node:12.22.5
    entrypoint: yarn
    args: ['run', 'build']
    env:
      # API
      - VUE_APP_API_BASE_URL=${_VUE_APP_API_BASE_URL}
      # Authentication
      - __VUE_APP_AUTH_BASE_URL=${_VUE_APP_AUTH_BASE_URL}
      - __VUE_APP_GOOGLE_OAUTH2_URL=${_VUE_APP_GOOGLE_OAUTH2_URL}
      - __VUE_APP_GOOGLE_OAUTH2_CLIENT_ID=${_VUE_APP_GOOGLE_OAUTH2_CLIENT_ID}
      - __VUE_APP_SERVER_AUTH_REDIRECT=${_VUE_APP_SERVER_AUTH_REDIRECT}
      - __VUE_APP_STRIPE_PUBLIC_KEY=pk_test_51I8oL1Kz3TV8XBbdR4RDihqTano7JKggDQRkj6bX2ZEezDe8K2WbvvfbdsdXRa67QmWAuLHUHjpnz3Xdpa0M72Gs005vktIlHN'
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: ['app', 'deploy']
substitutions:
  _VUE_APP_API_BASE_URL: 'https://beta.api.achilio.com'
  _VUE_APP_AUTH_BASE_URL: 'https://beta.auth.achilio.com'
  _VUE_APP_GOOGLE_OAUTH2_URL: 'https://accounts.google.com/o/oauth2/v2/auth'
  _VUE_APP_GOOGLE_OAUTH2_CLIENT_ID: '293325499254-8h7bv5piflnjdoufjak8jjh03tpqss8b.apps.googleusercontent.com'
  _VUE_APP_SERVER_AUTH_REDIRECT: 'api/v1/auth/login/google/'
  _${_VUE_APP_STRIPE_PUBLIC_KEY}: VUE_APP_STRIPE_PUBLIC_KEY
timeout: 1200s
